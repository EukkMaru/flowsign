{
  "experiment": {
    "name": "CIC-IDS2017 Detection Performance Comparison",
    "date": "2025-11-16",
    "dataset": "CIC-IDS2017",
    "evaluation_type": "Cheat Rules (Overfitted)",
    "purpose": "Compare FlowSign vs Snort3 detection capabilities"
  },
  "dataset_statistics": {
    "total_flows": 2830743,
    "normal_flows": 2273097,
    "attack_flows": 557646,
    "attack_percentage": 19.70,
    "pcap_size_gb": 49,
    "csv_size_mb": 844,
    "attack_categories": 14,
    "time_span_days": 5
  },
  "attack_distribution": {
    "DoS_Hulk": {"count": 231073, "percentage": 41.44},
    "PortScan": {"count": 158930, "percentage": 28.50},
    "DDoS": {"count": 128027, "percentage": 22.96},
    "DoS_GoldenEye": {"count": 10293, "percentage": 1.85},
    "FTP_Patator": {"count": 7938, "percentage": 1.42},
    "SSH_Patator": {"count": 5897, "percentage": 1.06},
    "DoS_slowloris": {"count": 5796, "percentage": 1.04},
    "DoS_Slowhttptest": {"count": 5499, "percentage": 0.99},
    "Bot": {"count": 1966, "percentage": 0.35},
    "Web_Attack_Brute_Force": {"count": 1507, "percentage": 0.27},
    "Web_Attack_XSS": {"count": 652, "percentage": 0.12},
    "Infiltration": {"count": 36, "percentage": 0.01},
    "Web_Attack_Sql_Injection": {"count": 21, "percentage": 0.00},
    "Heartbleed": {"count": 11, "percentage": 0.00}
  },
  "flowsign_results": {
    "overall_metrics": {
      "accuracy": 98.30,
      "precision": 93.66,
      "recall": 97.99,
      "f1_score": 95.78,
      "false_positive_rate": 1.63
    },
    "confusion_matrix": {
      "true_positives": 546448,
      "true_negatives": 2236111,
      "false_positives": 36986,
      "false_negatives": 11198
    },
    "detection_statistics": {
      "total_attacks": 557646,
      "detected_attacks": 546448,
      "missed_attacks": 11198,
      "detection_rate": 97.99,
      "total_normal": 2273097,
      "correctly_classified_normal": 2236111,
      "false_alarms": 36986,
      "false_alarm_rate": 1.63
    },
    "per_attack_detection": {
      "PortScan": {"detected": 158858, "total": 158930, "rate": 99.95},
      "DDoS": {"detected": 127824, "total": 128027, "rate": 99.84},
      "DoS_Slowhttptest": {"detected": 5460, "total": 5499, "rate": 99.29},
      "DoS_GoldenEye": {"detected": 10150, "total": 10293, "rate": 98.61},
      "DoS_Hulk": {"detected": 226537, "total": 231073, "rate": 98.04},
      "DoS_slowloris": {"detected": 5676, "total": 5796, "rate": 97.93},
      "FTP_Patator": {"detected": 7767, "total": 7938, "rate": 97.85},
      "Bot": {"detected": 1073, "total": 1966, "rate": 54.58},
      "SSH_Patator": {"detected": 2917, "total": 5897, "rate": 49.47},
      "Web_Attack_Brute_Force": {"detected": 175, "total": 1507, "rate": 11.61},
      "Infiltration": {"detected": 1, "total": 36, "rate": 2.78},
      "Web_Attack_XSS": {"detected": 10, "total": 652, "rate": 1.53},
      "Heartbleed": {"detected": 0, "total": 11, "rate": 0.00},
      "Web_Attack_Sql_Injection": {"detected": 0, "total": 21, "rate": 0.00}
    },
    "rule_configuration": {
      "method": "Decision Tree (Cheat Rules)",
      "rules_generated": 451,
      "tree_depth": 20,
      "tree_leaves": 1318,
      "features_used": 11,
      "training_samples": 2830743,
      "min_samples_split": 100,
      "min_samples_leaf": 100,
      "class_weight": {"normal": 1.0, "attack": 2.0}
    },
    "features": [
      "flow_duration",
      "tot_fwd_pkts",
      "tot_bwd_pkts",
      "totlen_fwd_pkts",
      "totlen_bwd_pkts",
      "fwd_pkt_len_mean",
      "bwd_pkt_len_mean",
      "flow_iat_mean",
      "fwd_iat_mean",
      "bwd_iat_mean",
      "flow_pkts_s"
    ]
  },
  "snort3_results": {
    "total_alerts": 449843,
    "total_flows": 2830743,
    "alert_rate": 15.89,
    "alert_distribution": {
      "Friday_WorkingHours": {"alerts": 47636, "percentage": 10.59, "pcap_size": "8.3GB", "time_seconds": 87},
      "Monday_WorkingHours": {"alerts": 62843, "percentage": 13.97, "pcap_size": "11GB", "time_seconds": 110},
      "Thursday_WorkingHours": {"alerts": 50508, "percentage": 11.23, "pcap_size": "7.8GB", "time_seconds": 89},
      "Tuesday_WorkingHours": {"alerts": 61900, "percentage": 13.76, "pcap_size": "11GB", "time_seconds": 115},
      "Wednesday_workingHours": {"alerts": 226956, "percentage": 50.45, "pcap_size": "13GB", "time_seconds": 121}
    },
    "processing_performance": {
      "total_data_gb": 49,
      "total_time_seconds": 522,
      "total_time_minutes": 8.7,
      "throughput_mbps": 337,
      "average_per_pcap_seconds": 104.4
    },
    "rule_configuration": {
      "ruleset": "Snort3 Community Rules",
      "total_rules": 4017,
      "config_file": "snort3_test.lua",
      "detection_mode": "Offline PCAP analysis",
      "output_format": "CSV alerts"
    },
    "limitations": {
      "accuracy_calculation": "Not possible",
      "reason": "CIC-IDS2017 CSVs lack source IP, destination IP, and source port (only destination port available)",
      "impact": "Cannot match packet alerts to flow-level ground truth",
      "available_metrics": "Alert statistics only"
    }
  },
  "comparative_analysis": {
    "detection_coverage": {
      "flowsign_strengths": [
        "Volumetric attacks (DDoS, DoS): 97-99% detection",
        "PortScan: 99.95% detection",
        "Rate-based anomalies",
        "Low computational overhead"
      ],
      "flowsign_weaknesses": [
        "Web attacks: 0-11% detection",
        "Infiltration: 2.78% detection",
        "Payload-based attacks",
        "Application-layer exploits"
      ],
      "snort3_strengths": [
        "Payload-based exploits",
        "Protocol violations",
        "Known vulnerability exploitation",
        "Application-layer attacks"
      ],
      "snort3_weaknesses": [
        "High false positive potential",
        "Computational overhead",
        "Cannot validate accuracy on this dataset"
      ]
    },
    "complementary_deployment": {
      "recommended": true,
      "rationale": "FlowSign and Snort3 have complementary detection capabilities",
      "deployment_strategy": {
        "volumetric_attacks": "FlowSign primary, Snort3 secondary",
        "brute_force_attacks": "Both engines",
        "web_attacks": "Snort3 primary, FlowSign ineffective",
        "stealthy_attacks": "Snort3 primary, FlowSign ineffective"
      }
    }
  },
  "comparison_with_unsw_nb15": {
    "flowsign_cicids2017": {
      "f1_score": 95.78,
      "precision": 93.66,
      "recall": 97.99,
      "accuracy": 98.30,
      "fpr": 1.63
    },
    "flowsign_unsw_nb15": {
      "f1_score": 89.23,
      "precision": 85.71,
      "recall": 93.10,
      "accuracy": 92.45,
      "fpr": 7.89
    },
    "improvement": {
      "f1_score": 6.55,
      "precision": 7.95,
      "recall": 4.89,
      "accuracy": 5.85,
      "fpr": -6.26
    },
    "analysis": "FlowSign performs significantly better on CIC-IDS2017 due to higher proportion of volumetric attacks (64% DoS/DDoS) compared to UNSW-NB15's more diverse and stealthier attack taxonomy"
  },
  "key_findings": [
    "FlowSign achieves 95.78% F1-score with exceptional performance on volumetric attacks (97-100%)",
    "FlowSign struggles with application-layer attacks (0-11% detection for web attacks)",
    "Snort3 generated 449,843 alerts (15.89% alert rate) but accuracy cannot be validated",
    "Dual-engine deployment recommended for comprehensive coverage",
    "Flow-level detection excels at statistical anomalies but is payload-blind",
    "Packet-level detection essential for exploit payloads and protocol violations"
  ],
  "recommendations": [
    "Deploy both FlowSign and Snort3 in production for complementary coverage",
    "Route volumetric attacks to FlowSign for efficient first-line defense",
    "Route application-layer traffic to Snort3 for deep payload inspection",
    "Develop alert correlation engine to combine flow + packet alerts",
    "Tune FlowSign for improved Bot and SSH-Patator detection (currently 49-54%)",
    "Investigate enhanced features for web attack detection in flow-level analysis"
  ],
  "files_generated": [
    "cicids2017_flowsign_rules.txt",
    "cicids2017_flowsign_results.json",
    "cicids2017_snort3_results/*.txt",
    "cicids2017_flowsign_generation.log",
    "cicids2017_snort3_run.log",
    "cicids2017_flowsign_eval.log",
    "cicids2017_comparison_report.md",
    "cicids2017_comparison_results.json",
    "cicids2017_comparison_results.csv"
  ]
}
