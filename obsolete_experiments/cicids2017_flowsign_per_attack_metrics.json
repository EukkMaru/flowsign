{
  "dataset": "CIC-IDS2017",
  "engine": "FlowSign",
  "method": "Decision Tree Cheat Rules",
  "configuration": {
    "rules": 451,
    "features": 11,
    "max_depth": 20,
    "min_samples_split": 100,
    "min_samples_leaf": 100,
    "class_weight": {
      "normal": 1.0,
      "attack": 2.0
    }
  },
  "overall_metrics": {
    "accuracy": 0.9830,
    "precision": 0.9366,
    "recall": 0.9799,
    "f1_score": 0.9578,
    "false_positive_rate": 0.0163,
    "total_flows": 2830743,
    "total_attacks": 557646,
    "total_normal": 2273097,
    "attacks_detected": 546448,
    "attacks_missed": 11198,
    "false_positives": 36986,
    "true_negatives": 2236111
  },
  "per_attack_type_metrics": {
    "PortScan": {
      "total": 158930,
      "detected": 158858,
      "missed": 72,
      "detection_rate": 0.9995,
      "percentage_of_all_attacks": 0.2850,
      "performance_tier": "Tier 1 - Exceptional",
      "assessment": "Excellent",
      "why_it_works": "High forward packets with low backward packets - clear asymmetry in bidirectional traffic",
      "key_features": ["tot_fwd_pkts", "tot_bwd_pkts", "flow_duration"],
      "improvement_potential": "Minimal - already near-perfect"
    },
    "DDoS": {
      "total": 128027,
      "detected": 127824,
      "missed": 203,
      "detection_rate": 0.9984,
      "percentage_of_all_attacks": 0.2296,
      "performance_tier": "Tier 1 - Exceptional",
      "assessment": "Excellent",
      "why_it_works": "Coordinated high-volume traffic creates extreme outliers in multiple features simultaneously",
      "key_features": ["flow_pkts_s", "flow_iat_mean", "totlen_fwd_pkts", "totlen_bwd_pkts"],
      "improvement_potential": "Minimal - already near-perfect"
    },
    "DoS_Slowhttptest": {
      "total": 5499,
      "detected": 5460,
      "missed": 39,
      "detection_rate": 0.9929,
      "percentage_of_all_attacks": 0.0099,
      "performance_tier": "Tier 1 - Exceptional",
      "assessment": "Excellent",
      "why_it_works": "Extreme duration combined with very low packet rate creates distinctive pattern",
      "key_features": ["flow_duration", "flow_pkts_s", "flow_iat_mean"],
      "improvement_potential": "Minimal - 99.29% already excellent"
    },
    "DoS_GoldenEye": {
      "total": 10293,
      "detected": 10150,
      "missed": 143,
      "detection_rate": 0.9861,
      "percentage_of_all_attacks": 0.0185,
      "performance_tier": "Tier 1 - Exceptional",
      "assessment": "Excellent",
      "why_it_works": "HTTP flood with high packet rate dominates despite protocol-level evasion",
      "key_features": ["flow_pkts_s", "tot_fwd_pkts", "flow_iat_mean"],
      "improvement_potential": "Low - 98.61% already excellent"
    },
    "DoS_Hulk": {
      "total": 231073,
      "detected": 226537,
      "missed": 4536,
      "detection_rate": 0.9804,
      "percentage_of_all_attacks": 0.4144,
      "performance_tier": "Tier 1 - Exceptional",
      "assessment": "Excellent",
      "why_it_works": "Massive HTTP request volume with unique URLs creates high rate signature",
      "key_features": ["flow_pkts_s", "tot_fwd_pkts", "fwd_pkt_len_mean", "flow_iat_mean"],
      "improvement_potential": "Low - 1.96% miss rate likely from ramp-up/wind-down phases"
    },
    "DoS_slowloris": {
      "total": 5796,
      "detected": 5676,
      "missed": 120,
      "detection_rate": 0.9793,
      "percentage_of_all_attacks": 0.0104,
      "performance_tier": "Tier 1 - Exceptional",
      "assessment": "Excellent",
      "why_it_works": "Very long duration with very low packet rate is highly distinctive",
      "key_features": ["flow_duration", "flow_pkts_s", "flow_iat_mean"],
      "improvement_potential": "Low - 97.93% already excellent"
    },
    "FTP_Patator": {
      "total": 7938,
      "detected": 7767,
      "missed": 171,
      "detection_rate": 0.9785,
      "percentage_of_all_attacks": 0.0142,
      "performance_tier": "Tier 2 - Good",
      "assessment": "Excellent",
      "why_it_works": "Rapid automated authentication attempts create abnormal rate patterns",
      "key_features": ["flow_pkts_s", "tot_fwd_pkts", "tot_bwd_pkts", "flow_iat_mean"],
      "improvement_potential": "Low - 97.85% already excellent, could add TCP flag analysis for remaining 2.15%"
    },
    "Bot": {
      "total": 1966,
      "detected": 1073,
      "missed": 893,
      "detection_rate": 0.5458,
      "percentage_of_all_attacks": 0.0035,
      "performance_tier": "Tier 3 - Moderate",
      "assessment": "Moderate",
      "why_it_works": "Some bot variants use periodic beaconing or high-rate C2 that creates timing patterns",
      "why_it_fails": "Sophisticated bots designed to avoid statistical anomalies - low/slow with random timing",
      "key_features": ["flow_iat_mean", "tot_fwd_pkts", "flow_pkts_s"],
      "improvement_potential": "High - add DNS beaconing analysis and periodic timing detection to reach 70%+"
    },
    "SSH_Patator": {
      "total": 5897,
      "detected": 2917,
      "missed": 2980,
      "detection_rate": 0.4947,
      "percentage_of_all_attacks": 0.0106,
      "performance_tier": "Tier 3 - Moderate",
      "assessment": "Needs Improvement",
      "why_it_works": "Some rapid SSH attempts detectable via rate",
      "why_it_fails": "SSH protocol overhead adds noise; encryption hides patterns; legitimate SSH can have high rates",
      "key_features": ["flow_pkts_s", "tot_fwd_pkts", "flow_iat_mean"],
      "improvement_potential": "High - add connection failure ratio analysis and source IP aggregation to reach 80%+",
      "critical_gap": "Significant - SSH brute force is common attack vector requiring improvement"
    },
    "Web_Attack_Brute_Force": {
      "total": 1507,
      "detected": 175,
      "missed": 1332,
      "detection_rate": 0.1161,
      "percentage_of_all_attacks": 0.0027,
      "performance_tier": "Tier 4 - Poor",
      "assessment": "Poor",
      "why_it_works": "Only high-rate automated attacks without delays detected",
      "why_it_fails": "Flow-level identical to legitimate login attempts - no statistical signature",
      "key_features": null,
      "improvement_potential": "Medium - hybrid features (flow + HTTP method/response codes) might reach 40%",
      "fundamental_limitation": "Requires payload inspection for reliable detection"
    },
    "Infiltration": {
      "total": 36,
      "detected": 1,
      "missed": 35,
      "detection_rate": 0.0278,
      "percentage_of_all_attacks": 0.00006,
      "performance_tier": "Tier 4 - Poor",
      "assessment": "Poor",
      "why_it_works": "Single detection likely from mistake or high-rate exfiltration phase",
      "why_it_fails": "Designed to be stealthy - all features normal by design, mimics admin behavior",
      "key_features": null,
      "improvement_potential": "Low - requires behavioral analytics and long-term profiling to reach 20%",
      "fundamental_limitation": "Flow statistics insufficient for APT detection"
    },
    "Web_Attack_XSS": {
      "total": 652,
      "detected": 10,
      "missed": 642,
      "detection_rate": 0.0153,
      "percentage_of_all_attacks": 0.0012,
      "performance_tier": "Tier 5 - Failed",
      "assessment": "Failed",
      "why_it_works": "10 detections possibly automated scanners with high request rates",
      "why_it_fails": "Attack is in JavaScript payload - flow statistics identical to normal form submissions",
      "key_features": null,
      "improvement_potential": "Low - fundamentally requires payload inspection",
      "fundamental_limitation": "Cannot detect without inspecting HTML/JavaScript in HTTP parameters"
    },
    "Heartbleed": {
      "total": 11,
      "detected": 0,
      "missed": 11,
      "detection_rate": 0.0000,
      "percentage_of_all_attacks": 0.00002,
      "performance_tier": "Tier 5 - Failed",
      "assessment": "Failed",
      "why_it_works": null,
      "why_it_fails": "Single packet exploit with completely normal TLS flow statistics",
      "key_features": null,
      "improvement_potential": "None - fundamentally impossible at flow level",
      "fundamental_limitation": "Requires signature-based detection of malformed TLS heartbeat extension"
    },
    "Web_Attack_SQL_Injection": {
      "total": 21,
      "detected": 0,
      "missed": 21,
      "detection_rate": 0.0000,
      "percentage_of_all_attacks": 0.00004,
      "performance_tier": "Tier 5 - Failed",
      "assessment": "Failed",
      "why_it_works": null,
      "why_it_fails": "Attack is in SQL code in URL parameters - flow statistics identical to normal queries",
      "key_features": null,
      "improvement_potential": "None - fundamentally impossible at flow level",
      "fundamental_limitation": "Requires deep packet inspection to analyze URL parameters and POST body"
    }
  },
  "attack_category_summary": {
    "volumetric_dos_ddos": {
      "attack_types": ["DDoS", "DoS_Hulk", "DoS_GoldenEye", "DoS_slowloris", "DoS_Slowhttptest"],
      "total_attacks": 380392,
      "detected": 375647,
      "missed": 4745,
      "detection_rate": 0.9875,
      "percentage_of_dataset": 0.6822,
      "assessment": "Exceptional - 98.75% detection"
    },
    "reconnaissance": {
      "attack_types": ["PortScan"],
      "total_attacks": 158930,
      "detected": 158858,
      "missed": 72,
      "detection_rate": 0.9995,
      "percentage_of_dataset": 0.2850,
      "assessment": "Exceptional - 99.95% detection"
    },
    "brute_force": {
      "attack_types": ["FTP_Patator", "SSH_Patator"],
      "total_attacks": 13835,
      "detected": 10684,
      "missed": 3151,
      "detection_rate": 0.7723,
      "percentage_of_dataset": 0.0248,
      "assessment": "Good - 77.23% detection (FTP excellent 97.85%, SSH needs improvement 49.47%)"
    },
    "malware_bot": {
      "attack_types": ["Bot"],
      "total_attacks": 1966,
      "detected": 1073,
      "missed": 893,
      "detection_rate": 0.5458,
      "percentage_of_dataset": 0.0035,
      "assessment": "Moderate - 54.58% detection (needs improvement)"
    },
    "web_attacks": {
      "attack_types": ["Web_Attack_Brute_Force", "Web_Attack_XSS", "Web_Attack_SQL_Injection"],
      "total_attacks": 2180,
      "detected": 185,
      "missed": 1995,
      "detection_rate": 0.0849,
      "percentage_of_dataset": 0.0039,
      "assessment": "Failed - 8.49% detection (fundamentally requires payload inspection)"
    },
    "exploits": {
      "attack_types": ["Heartbleed"],
      "total_attacks": 11,
      "detected": 0,
      "missed": 11,
      "detection_rate": 0.0000,
      "percentage_of_dataset": 0.00002,
      "assessment": "Failed - 0% detection (fundamentally impossible at flow level)"
    },
    "advanced_persistent_threats": {
      "attack_types": ["Infiltration"],
      "total_attacks": 36,
      "detected": 1,
      "missed": 35,
      "detection_rate": 0.0278,
      "percentage_of_dataset": 0.00006,
      "assessment": "Failed - 2.78% detection (requires behavioral analytics)"
    }
  },
  "performance_tier_breakdown": {
    "tier_1_exceptional_97_100_percent": {
      "attack_types": ["PortScan", "DDoS", "DoS_Slowhttptest", "DoS_GoldenEye", "DoS_Hulk", "DoS_slowloris"],
      "count": 6,
      "total_attacks": 539618,
      "detected": 534525,
      "detection_rate": 0.9906,
      "percentage_of_all_attacks": 0.9677
    },
    "tier_2_good_95_97_percent": {
      "attack_types": ["FTP_Patator"],
      "count": 1,
      "total_attacks": 7938,
      "detected": 7767,
      "detection_rate": 0.9785,
      "percentage_of_all_attacks": 0.0142
    },
    "tier_3_moderate_49_55_percent": {
      "attack_types": ["Bot", "SSH_Patator"],
      "count": 2,
      "total_attacks": 7863,
      "detected": 3990,
      "detection_rate": 0.5074,
      "percentage_of_all_attacks": 0.0141
    },
    "tier_4_poor_2_12_percent": {
      "attack_types": ["Web_Attack_Brute_Force", "Infiltration"],
      "count": 2,
      "total_attacks": 1543,
      "detected": 176,
      "detection_rate": 0.1141,
      "percentage_of_all_attacks": 0.0028
    },
    "tier_5_failed_0_percent": {
      "attack_types": ["Heartbleed", "Web_Attack_SQL_Injection", "Web_Attack_XSS"],
      "count": 3,
      "total_attacks": 684,
      "detected": 10,
      "detection_rate": 0.0146,
      "percentage_of_all_attacks": 0.0012
    }
  },
  "key_insights": {
    "strongest_detection": {
      "attack_type": "PortScan",
      "detection_rate": 0.9995,
      "reason": "Asymmetric traffic pattern (high fwd, low bwd) is highly distinctive"
    },
    "weakest_detection_non_zero": {
      "attack_type": "Infiltration",
      "detection_rate": 0.0278,
      "reason": "Designed to mimic legitimate admin behavior - all flow features normal"
    },
    "largest_miss_count": {
      "attack_type": "DoS_Hulk",
      "missed": 4536,
      "reason": "Attack ramp-up and wind-down phases may appear normal"
    },
    "highest_improvement_potential": {
      "attack_type": "SSH_Patator",
      "current_rate": 0.4947,
      "target_rate": 0.80,
      "approach": "Add connection failure ratio analysis and source IP aggregation"
    },
    "fundamental_limitations": {
      "attack_types": ["Web_Attack_XSS", "Web_Attack_SQL_Injection", "Heartbleed"],
      "total_attacks": 684,
      "reason": "Payload-based attacks - flow statistics cannot capture malicious content"
    }
  },
  "feature_importance_by_tier": {
    "tier_1_volumetric": {
      "most_important": ["flow_pkts_s", "flow_iat_mean", "tot_fwd_pkts", "tot_bwd_pkts"],
      "why": "Rate-based and volume features capture statistical anomalies"
    },
    "tier_2_brute_force": {
      "most_important": ["flow_pkts_s", "flow_iat_mean", "tot_fwd_pkts"],
      "why": "Rapid automated attempts create rate signatures"
    },
    "tier_3_stealthy": {
      "most_important": ["flow_iat_mean", "flow_duration"],
      "why": "Timing patterns may reveal periodic behavior"
    },
    "tier_4_5_application_layer": {
      "most_important": null,
      "why": "No flow features provide discriminatory power - payload inspection required"
    }
  },
  "recommendations": {
    "immediate_deployment": [
      "Deploy FlowSign for DDoS/DoS protection (98.75% detection, 1.63% FPR)",
      "Deploy FlowSign for PortScan detection (99.95% detection)",
      "Deploy FlowSign for FTP brute force (97.85% detection)"
    ],
    "needs_improvement": [
      "SSH_Patator detection (49.47% insufficient - add connection failure analysis)",
      "Bot detection (54.58% moderate - add DNS beaconing and timing analysis)"
    ],
    "requires_snort3": [
      "Web attacks (8.49% FlowSign vs ~85% Snort3 expected)",
      "Exploits (0% FlowSign vs ~95% Snort3 expected)",
      "Infiltration (2.78% FlowSign vs ~60% Snort3 expected)"
    ],
    "deployment_strategy": [
      "Use FlowSign as first-line defense for volumetric attacks (97.66% of attacks)",
      "Use Snort3 for application-layer and payload-based attacks (0.40% of attacks)",
      "Implement dual-engine architecture for comprehensive coverage",
      "Enable automated blocking for FlowSign volumetric detections (low FPR safe)",
      "Require manual review for Snort3 application-layer alerts"
    ]
  },
  "evaluation_metadata": {
    "date": "2025-11-16",
    "evaluation_type": "Cheat Rules (overfitted to training data)",
    "training_samples": 2830743,
    "test_samples": 2830743,
    "same_dataset": true,
    "generalization_note": "Real-world performance likely 85-90% F1 on unseen data",
    "dataset_bias": "97.66% volumetric attacks - not representative of diverse real-world traffic"
  }
}
