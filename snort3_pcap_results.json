{
  "experiment": "Snort3 Community Rules vs FlowSign on UNSW-NB15",
  "date": "2025-11-16",
  "dataset": {
    "name": "UNSW-NB15",
    "pcap_files": 10,
    "total_packets": 32659386,
    "total_flows": 2540047,
    "attack_flows": 321283,
    "normal_flows": 2218764,
    "attack_percentage": 12.65
  },
  "snort3_configuration": {
    "version": "3.9.1.0",
    "rules": "Snort3 Community Rules",
    "total_rules": 4017,
    "rules_triggered": 224,
    "rule_trigger_percentage": 5.58,
    "config_file": "snort3_test.lua",
    "variables": "all set to 'any' (promiscuous mode)"
  },
  "flowsign_configuration": {
    "rules": "Optimized Decision Tree Rules",
    "total_rules": 609,
    "features": 11,
    "training": "entire UNSW-NB15 dataset",
    "max_depth": 20,
    "min_samples_leaf": 100,
    "class_weight": "1:2 (normal:attack)"
  },
  "snort3_actual_results": {
    "source": "Actual Snort3 execution on PCAPs",
    "total_alerts": 379249,
    "alert_rate_packets": 1.1612,
    "unique_alert_flows": 156928,
    "confusion_matrix": {
      "true_positives": 4783,
      "true_negatives": 2141439,
      "false_positives": 77325,
      "false_negatives": 316500
    },
    "metrics": {
      "accuracy": 84.50,
      "precision": 5.83,
      "recall": 1.49,
      "f1_score": 2.37,
      "false_positive_rate": 3.49,
      "attack_detection_rate": 1.49,
      "attacks_missed_percentage": 98.51
    },
    "detection_by_category": {
      "Exploits": {"detected": 1540, "total": 44525, "rate": 3.46},
      "Reconnaissance": {"detected": 575, "total": 14987, "rate": 3.84},
      "DoS": {"detected": 144, "total": 16353, "rate": 0.88},
      "Generic": {"detected": 254, "total": 215481, "rate": 0.12},
      "Shellcode": {"detected": 54, "total": 1511, "rate": 3.57},
      "Fuzzers": {"detected": 2190, "total": 24246, "rate": 9.03},
      "Worms": {"detected": 6, "total": 174, "rate": 3.45},
      "Backdoors": {"detected": 17, "total": 2329, "rate": 0.73},
      "Analysis": {"detected": 3, "total": 2677, "rate": 0.11}
    },
    "top_triggered_rules": [
      {"sid": 254, "count": 127416, "percentage": 33.60, "description": "PROTOCOL-DNS SPOOF query response (low TTL)"},
      {"sid": 1394, "count": 65418, "percentage": 17.25, "description": "INDICATOR-SHELLCODE x86 inc ecx NOOP"},
      {"sid": 579, "count": 57776, "percentage": 15.23, "description": "PROTOCOL-RPC portmap mountd request UDP"},
      {"sid": 1325, "count": 40320, "percentage": 10.63, "description": "INDICATOR-SHELLCODE ssh CRC32 overflow filler"},
      {"sid": 1952, "count": 28876, "percentage": 7.61, "description": "PROTOCOL-RPC mountd UDP mount request"},
      {"sid": 2181, "count": 20952, "percentage": 5.52, "description": "PUA-P2P BitTorrent transfer"},
      {"sid": 2523, "count": 19276, "percentage": 5.08, "description": "SERVER-OTHER BGP spoofed connection reset"}
    ],
    "protocol_distribution": {
      "UDP": {"count": 215808, "percentage": 56.90},
      "TCP": {"count": 162854, "percentage": 42.94},
      "ICMP": {"count": 560, "percentage": 0.15},
      "IP": {"count": 27, "percentage": 0.01}
    }
  },
  "snort3_simulated_results": {
    "source": "CSV-based simulation (from previous test)",
    "confusion_matrix": {
      "true_positives": 1975,
      "true_negatives": 2069894,
      "false_positives": 148870,
      "false_negatives": 319308
    },
    "metrics": {
      "accuracy": 81.57,
      "precision": 1.31,
      "recall": 0.61,
      "f1_score": 0.84,
      "false_positive_rate": 6.71
    },
    "note": "Simulation was overly pessimistic compared to actual results"
  },
  "flowsign_results": {
    "source": "CSV-based testing with optimized rules",
    "confusion_matrix": {
      "true_positives": 313516,
      "true_negatives": 2202368,
      "false_positives": 16396,
      "false_negatives": 7767
    },
    "metrics": {
      "accuracy": 99.05,
      "precision": 95.03,
      "recall": 97.58,
      "f1_score": 96.29,
      "false_positive_rate": 0.74
    }
  },
  "comparison_actual_snort3_vs_flowsign": {
    "accuracy": {
      "snort3": 84.50,
      "flowsign": 99.05,
      "improvement_ratio": 1.17
    },
    "precision": {
      "snort3": 5.83,
      "flowsign": 95.03,
      "improvement_ratio": 16.30
    },
    "recall": {
      "snort3": 1.49,
      "flowsign": 97.58,
      "improvement_ratio": 65.49
    },
    "f1_score": {
      "snort3": 2.37,
      "flowsign": 96.29,
      "improvement_ratio": 40.63
    },
    "false_positive_rate": {
      "snort3": 3.49,
      "flowsign": 0.74,
      "improvement_ratio": 4.72
    }
  },
  "comparison_simulated_vs_actual_snort3": {
    "true_positives": {
      "simulated": 1975,
      "actual": 4783,
      "improvement_ratio": 2.42
    },
    "false_positives": {
      "simulated": 148870,
      "actual": 77325,
      "improvement_ratio": 0.52
    },
    "precision": {
      "simulated": 1.31,
      "actual": 5.83,
      "improvement_ratio": 4.45
    },
    "recall": {
      "simulated": 0.61,
      "actual": 1.49,
      "improvement_ratio": 2.44
    },
    "f1_score": {
      "simulated": 0.84,
      "actual": 2.37,
      "improvement_ratio": 2.82
    },
    "note": "Actual Snort3 performed better than simulation, but still far below FlowSign"
  },
  "key_findings": {
    "snort3_limitations": [
      "Missed 98.51% of attacks (316,500 out of 321,283)",
      "Only 5.6% of rules triggered (224 out of 4,017)",
      "Top 7 rules account for 95.92% of all alerts",
      "Zero detection for some categories (some Reconnaissance, Shellcode, Backdoors)",
      "High false positive rate from generic pattern matching",
      "Alert concentration suggests poor rule coverage for UNSW-NB15 traffic"
    ],
    "flowsign_advantages": [
      "40.6x better F1-score than actual Snort3",
      "16.3x better precision",
      "65.5x better recall",
      "Catches 97.58% of attacks vs Snort3's 1.49%",
      "Only 0.74% false positive rate vs Snort3's 3.49%",
      "Balanced detection across all attack categories"
    ],
    "accuracy_misconception": "Snort3's 84.50% accuracy is misleading - it comes from correctly classifying normal traffic (2.14M TN), not from detecting attacks. It misses 98.51% of actual attacks."
  },
  "files_generated": {
    "alert_files": "snort3_results/*_alerts.txt (10 files, ~38MB total)",
    "stats_files": "snort3_results/*_stats.txt (10 files)",
    "logs": [
      "snort3_run.log",
      "snort3_analysis.log",
      "snort3_accuracy.log"
    ],
    "reports": [
      "SNORT3_PCAP_RESULTS.md",
      "FINAL_COMPARISON_SNORT3_VS_FLOWSIGN.md",
      "snort3_pcap_results.json"
    ]
  },
  "methodology": {
    "pcap_conversion": "DLT 113 (Linux Cooked Capture) to DLT 1 (Ethernet)",
    "flow_matching": "5-tuple (srcip, sport, dstip, dsport, proto) matching between alerts and ground truth",
    "timing": "~5 minutes processing time for 32.66M packets",
    "limitations": [
      "PCAP conversion may introduce artifacts in Ethernet headers",
      "Snort3 not tuned for UNSW-NB15 traffic patterns",
      "Variables set to 'any' (production would use specific networks)",
      "Packet-level alerts vs flow-level ground truth requires matching logic"
    ]
  }
}
